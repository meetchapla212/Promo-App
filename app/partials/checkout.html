<div ng-controller="checkoutController">
    <div loader working="loading" message="loadingMessage" disable-background="true" class="loader-content"
        ng-class="{'checkout-loader': loadingInit}">
    </div>
    <div flex layout="column" layout-align="start stretch" class="mobile-hide pa-bg-EEEEEE">
        
        <div flex class="pa-bg-EEEEEE mobile-hide">
            <div class="container-wtd-1170">
                <div class="tt-border tt-checkout-div-padding tt-padding-media-zero pa-modal-font tt-background-EEEEEE "
                    ng-show="false">
                    <div class="row">
                        <div class="col-md-9">
                            <div class="tt-padding-20 pa-background-white tt-padding-media-8  tt-border-radius-top">
                                <div class="row tt-media-background-EEEEEE tt-media-margin">
                                    <div class="col-md-12 tt-media-center-align">
                                        <h1
                                            class="tt-ticket-heading pa-bold-font tt-media-font-18 tt-media-color-3B373C ">
                                            Checkout</h1>
                                    </div>
                                </div>
                                <div class="row hidden-sm hidden-xs ">
                                    <div class="col-md-12">
                                        <h4 ng-click="goToTicketType()"
                                            class="pa-font-bold pa-color-pink cursor-pointer tt-back-event-detail"><i
                                                class="material-icons tt-mr-10 pa-vertical-align">keyboard_arrow_left</i>
                                            Back to Select Ticket Type </h4>
                                    </div>
                                </div>
                                <div class="row tt-media-d-none-max">
                                    <div class="col-md-12">
                                        <h4 ng-click="goToTicketType()"
                                            class="pa-font-bold pa-color-pink cursor-pointer tt-back-event-detail"><i
                                                class="fa fa-angle-left tt-mr-10 tt-media-font-18 pa-font-bold cursor-pointer tt-media-icon"></i>
                                        </h4>
                                    </div>
                                </div>
                                <div
                                    class="tt-border-D9D7D7 pa-modal-font tt-padding-20 first-search-box tt-padding-media-8">
                                    <div class="row">
                                        <div class="col-md-6">
                                            <div ng-if="event.event_name"
                                                class="pa-font-20 pa-color-5B5B5B tt-media-color-3B373C tt-font-weight-900 tt-media-font-16">
                                                {{event.event_name}}</div>
                                        </div>
                                        <div class="col-md-3"></div>
                                        <div class="event_category_main">
                                            <div ng-if="event.category"
                                                class="pa-pr-0 tt-text-right-align tt-media-left-align "><img
                                                    ng-src="{{categoriesMap[event.category].icon}}" alt="category"
                                                    class="h-32"></div>
                                            <div ng-if="event.category" class="pa-pr-0 tt-media-pl-5 event_category">
                                                <div
                                                    class="pa-bold-font pa-color-5B5B5B tt-font-16 tt-media-color-3B373C pa-capitalize tt-media-font-14">
                                                    {{categoriesMap[event.category].name}}</div>
                                            </div>
                                        </div>
                                        <div class="col-md-12">
                                            <h4 class="pa-color-5B5B5B tt-font-16 tt-media-font-14"><i
                                                    class="material-icons tt-mr-10 tt-media-ml-12 pa-vertical-align">date_range
                                                </i> {{event.start_date_time | toMoment | momentFormatter:"ddd, MMMM DD,
                                                YYYY"}}</h4>
                                        </div>
                                        <div class="col-md-12">
                                            <h4 class="pa-color-5B5B5B tt-font-16 tt-media-font-14"><i
                                                    class="material-icons tt-mr-10 tt-media-ml-12 pa-vertical-align">access_time</i>
                                                {{event.start_date_time | toMoment | momentFormatter:"hh:mm a"}}</h4>
                                        </div>
                                        <div class="col-md-12">
                                            <h4 ng-if="event.address"
                                                class="pa-color-5B5B5B tt-font-16 tt-media-font-14"><i
                                                    class="material-icons tt-mr-10 tt-media-ml-12 pa-vertical-align">location_on</i>
                                                {{event.address}}</h4>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    class=" tt-padding-20 pa-background-white tt-padding-media-8 tt-border-radius-bottom tt-border-D9D7D7 mt-5">
                                    <div class="pa-modal-font tt-padding-media-8">
                                        <div class="row">
                                            <div class="col-md-3">
                                                <div
                                                    class="pa-font-20 pa-color-5B5B5B tt-media-color-3B373C tt-font-weight-900 tt-media-font-16">
                                                    Ticket Details</div>
                                            </div>
                                            <div class="col-md-9"></div>
                                        </div>


                                        <div ng-repeat="ticket in event.tickets" class="tc_checkout_deatils">
                                            <div ng-if="ticket.reserved && ticket.reserved>0">
                                                <div class="first-search-box">
                                                    <div class="chk-ticket-label">
                                                        <h4
                                                            class="pa-color-5B5B5B tt-media-color-3B373C tt-font-16 tt-media-font-14">
                                                            Ticket Type</h4>
                                                    </div>

                                                    <div class="tt-text-right-align chk-ticket-value">
                                                        <h4 ng-if="ticket.name"
                                                            class="pa-color-5B5B5B tt-media-color-3B373C tt-font-16 pa-bold-font tt-media-font-14 pa-word-break">
                                                            {{ ticket.name }}</h4>
                                                    </div>

                                                    <div class="chk-border-adust tt-border-dashed"></div>
                                                </div>
                                                <div class="chk-rows">
                                                    <div class="chk-ticket-label">
                                                        <h4
                                                            class="pa-color-5B5B5B tt-media-color-3B373C tt-font-16 tt-media-font-14">
                                                            Ticket Quantity</h4>
                                                    </div>

                                                    <div class="tt-text-right-align chk-ticket-value">
                                                        <h4
                                                            class="pa-color-5B5B5B tt-media-color-3B373C tt-font-16 pa-bold-font tt-media-font-14">
                                                            {{ ticket.reserved }}</h4>
                                                    </div>

                                                    <div class="chk-border-adust tt-border-dashed"></div>
                                                </div>
                                                <div class="chk-rows">
                                                    <div class="chk-ticket-label">
                                                        <h4
                                                            class="pa-color-5B5B5B tt-media-color-3B373C tt-font-16 tt-media-font-14">
                                                            Price Per Ticket</h4>
                                                    </div>

                                                    <div class="tt-text-right-align chk-ticket-value">
                                                        <h4
                                                            class="pa-color-5B5B5B tt-media-color-3B373C tt-font-16 pa-bold-font tt-media-font-14">
                                                            {{ ticket.currency }} {{ ticket.total_price }}</h4>
                                                    </div>
                                                    <div class="chk-border-adust tt-border-dashed"></div>
                                                </div>
                                            </div>
                                        </div>

                                        <div
                                            class="row tt-total-amount-div tt-background-EEEEEE tt-margin-8 tt-padding-media-8 tt-height-auto">
                                            <div
                                                class="col-md-4 col-xs-8 tt-media-right-align hidden-sm hidden-xs hidden-md">
                                                <h2 class="tt-ticket-heading tt-font-weight-900 tt-media-font-16">Total
                                                </h2>
                                            </div>
                                            <div
                                                class="col-md-8 col-xs-4 tt-text-right-align  tt-padding-media-zero hidden-sm hidden-xs hidden-md">
                                                <h2 class="tt-ticket-heading tt-font-weight-900 tt-media-font-16">
                                                    {{currency}} {{checkoutDetails.price}}</h2>
                                            </div>
                                            <div
                                                class="col-md-12 tt-text-right-align tt-media-pr-0 hidden-lg hidden-xl ">
                                                <h2 class="tt-ticket-heading tt-font-weight-900 tt-media-font-16">
                                                    Total<span> {{currency}} {{checkoutDetails.price}}</span></h2>
                                            </div>
                                        </div>
                                        <div class="row"
                                            ng-if="event.event_type === 'free' && isObjectEmpty(event.layout_details)">
                                            <div class="col-md-12 col-sm-12 col-xs-12 checkout_form">
                                                <button
                                                    class="pa-font-Lato pa-bold-font pa-border-4 pa-mt-0 tt-font-16 continue md-button ng-scope md-ink-ripple"
                                                    ng-click="buyFreeTicket()">Register</button>
                                            </div>
                                        </div>
                                        <div class="row"
                                            ng-if="event.ticket_type === 'free' && !isObjectEmpty(event.layout_details)">
                                            <div class="col-md-12 col-sm-12 col-xs-12 checkout_form">
                                                <button
                                                    class="pa-font-Lato pa-bold-font pa-border-4 pa-mt-0 tt-font-16 continue md-button ng-scope md-ink-ripple"
                                                    ng-click="buyTicket()">Register</button>
                                            </div>
                                        </div>
                                        <!-- form place holder -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div
                                class="tt-border-D9D7D7 tt-border-none tt-padding-20 tt-media-mb-50 tt-border-radius-7">
                                <div class="row">
                                    <div class="col-md-12">
                                        <div
                                            class="pa-font-20 pa-color-5B5B5B tt-media-color-3B373C tt-font-weight-900 tt-media-font-18">
                                            Receive Ticket</div>
                                    </div>
                                </div>
                                <div class="row first-search-box ">
                                    <div class="col-md-1 col-xs-1">
                                        <p class="pa-color-5B5B5B tt-font-16 tt-media-font-14"><i
                                                class="material-icons pa-font-14">check_circle</i></p>
                                    </div>
                                    <div class="col-md-10 col-xs-10">
                                        <p class="pa-color-5B5B5B tt-font-16 tt-line-height tt-media-font-14">You will
                                            receive the ticket in QR code form.</p>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-1 col-xs-1">
                                        <p class="pa-color-5B5B5B tt-font-16 tt-media-font-14"><i
                                                class="material-icons pa-font-14">check_circle</i></p>
                                    </div>
                                    <div class="col-md-10 col-xs-10">
                                        <p class="pa-color-5B5B5B tt-font-16 tt-line-height tt-media-font-14">After you
                                            pay for the tickets, your ticket will be shown as "pending" at your end
                                            until the event organizer confirms your ticket.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="tc_selection_main">
                    <div class="text-head">
                        <a ng-click="goToEventDetails();" class="back-to-btn"><i
                                class="material-icons">navigate_before</i> Back to Select Ticket Type</a>
                    </div>
                    <div class="tc_selection_wrap">
                        <div class="tc_selection_left_section" ng-hide="loading">
                            <div class="custom_section_check_seat with_timer_check">
                                <div class="secure_sec"> <i class="material-icons">lock</i> Secure Checkout</div>
                                <div class="timeer">Time left {{counter | counter | date:'mm:ss'}}</div>
                            </div>
                            <div class="seats_map_list ">
                                <div class="row"
                                    ng-if="event.event_type === 'free'  && isObjectEmpty(event.layout_details)">
                                    <div class="col-md-12 col-sm-12 col-xs-12 checkout_form">
                                        <button
                                            class="pa-font-Lato pa-bold-font pa-border-4 pa-mt-0 tt-font-16 continue md-button ng-scope md-ink-ripple"
                                            ng-click="buyFreeTicket()">Register</button>
                                    </div>
                                </div>
                                <div class="row"
                                    ng-if="event.event_type === 'free' && !isObjectEmpty(event.layout_details)">
                                    <div class="col-md-12 col-sm-12 col-xs-12 checkout_form">
                                        <button
                                            class="pa-font-Lato pa-bold-font pa-border-4 pa-mt-0 tt-font-16 continue md-button ng-scope md-ink-ripple"
                                            ng-click="buyTicket()">Register</button>
                                    </div>
                                </div>
                                <div class="checkout-form">
                                    <form action="/charge" ng-show="event.event_type && event.event_type !== 'free'"
                                        method="post" id="payment-form" class='stripe-form'>
                                        <input type="hidden" name="token" />
                                        <div class="group">
                                            <div class="outcome">
                                                <div class="error"></div>
                                            </div>
                                            <md-input-container class="form-group full-field pa-mt-30-imp" flex-gt-sm>
                                                <label>Card number <div class="pa-color-red pa-display-inline-block">*
                                                    </div>
                                                </label>
                                                <div id="card-number-element" class='stripe-field'></div>
                                                <span class="brand" id='brand-image'></span>
                                            </md-input-container>

                                            <md-input-container class="form-group half-field pa-mt-30-imp" flex-gt-sm>
                                                <label>Expiry date <div class="pa-color-red pa-display-inline-block">*
                                                    </div>
                                                </label>
                                                <div id="card-expiry-element" class='stripe-field'></div>
                                            </md-input-container>

                                            <md-input-container class="form-group half-field pa-mt-30-imp" flex-gt-sm>
                                                <label>CVC <div class="pa-color-red pa-display-inline-block">*</div>
                                                    </label>
                                                <div id="card-cvc-element" class='stripe-field'></div>
                                            </md-input-container>

                                            <md-input-container class="form-group full-field pa-mt-30-imp" flex-gt-sm>
                                                <label>Postal code <div class="pa-color-red pa-display-inline-block">*
                                                    </div>
                                                </label>
                                                <div id="card-postalcode-element" name="postal_code"
                                                    class='stripe-field' placeholder="90210"></div>
                                            </md-input-container>
                                        </div>
                                        <button type="submit" id="submit_button"
                                            class="pa-font-Lato pa-bold-font pa-border-4 tt-font-16 continue md-button ng-scope md-ink-ripple">Submit
                                            Payment</button>

                                    </form>
                                </div>
                            </div>
                        </div>

                        <div class="tc_selection_right_section">
                            <div class="tc_head_img_sec">
                                <span class="tc_head_img"><img ng-src="{{event.event_image}}" alt='image' /></span>
                                <span class="tc_head_img_content">{{ event.event_name}} <b> {{event.start_date_time |
                                        toMoment | momentFormatter:"ddd, MMM D, YYYY hh:mm a"}}</b></span>
                            </div>
                            <div class="order_summary">
                                <div class="order_summary_strip">
                                    <span class="order_summary_head">Order Summary</span>

                                    <button ng-if="event.is_attendee_pick == 1" class="order_sum_link"
                                        ng-click="openTicketPreview()">Preview</button>
                                </div>

                                <table>
                                    <thead>
                                        <tr>
                                            <th>Tickets</th>
                                            <th>Unit Price</th>
                                            <th>Total Price</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-if="price_calculation.length > 0"
                                            ng-repeat="ticke_Details in price_calculation">
                                            <td><span ng-if="ticke_Details._tier_id > 0"
                                                    style="background-color: {{ ticke_Details.tire_color  }};"></span>
                                                {{ ticke_Details.qty }} x {{ticke_Details.name }}</td>
                                            <td>${{ticke_Details.unit_price }}</td>
                                            <td>${{ticke_Details.total_price }}</td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr class="top_order_summary_space">
                                            <td>Sub Total</td>
                                            <td></td>
                                            <td>${{sub_total}}</td>
                                        </tr>
                                        <tr>
                                            <td>Fees</td>
                                            <td></td>
                                            <td>${{total_fee}}</td>
                                        </tr>
                                        <tr>
                                            <td><b>Total</b></td>
                                            <td></td>
                                            <td><b>${{total_amt}}</b></td>
                                        </tr>
                                    </tfoot>
                                </table>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
    </div>

    <!-- Mobile view -->
    <div flex class="desktop-hide mobile-org-ticket pa-background-white checkout-view">
        <div class="mobile-header d-hide desktop-hide">
            <div class="mobile-header-title">
                <span class="back-btn-mobile">
                    <!-- ng-click="goToTicketType()" -->
                    <a data-ng-href="" ng-click="goToEventDetails()"><i class="material-icons">arrow_back_ios</i></a>
                </span>
                <h2 class="pd-right-32" ng-click="goToEventDetails()">Checkout</h2>
                <button class="order_sum_link" ng-click="openTicketPreview()">Preview</button>
            </div>
        </div>
        <div class="tc_selection_left_section" ng-hide="loading">
            <div class="row" ng-if="event.event_type === 'free' && isObjectEmpty(event.layout_details)">
                <div class="col-md-12 col-sm-12 col-xs-12 continue-free">
                    <div class="noti_fiy_tc tc-seating-tooltips">
                        <i class="material-icons">info</i>
                        <p>Click on Register button to get ticket.</p>
                    </div>
                    <button
                        class="pa-font-Lato pa-bold-font pa-border-4 pa-mt-0 tt-font-16 continue md-button ng-scope md-ink-ripple"
                        ng-click="buyFreeTicket()">Register</button>
                </div>
            </div>
            <div class="row" ng-if="event.event_type === 'free' && !isObjectEmpty(event.layout_details)">
                <div class="col-md-12 col-sm-12 col-xs-12 continue-free">
                    <div class="noti_fiy_tc tc-seating-tooltips">
                        <i class="material-icons">info</i>
                        <p>Click on Register button to get ticket.</p>
                    </div>
                    <button
                        class="pa-font-Lato pa-bold-font pa-border-4 pa-mt-0 tt-font-16 continue md-button ng-scope md-ink-ripple"
                        ng-click="buyTicket()">Register</button>
                </div>
            </div>

            <form action="/charge" ng-show="event.event_type && event.event_type !== 'free'" method="post"
                class='stripe-form mobile-stripe-form' id="payment-form-2">
                <input type="hidden" name="token" />
                <div class="group" id="card-element-2">
                    <label class="with_timer_check" for="card-element-2">
                        Credit or debit card <div class="timeer">Time left {{counter | counter | date:'mm:ss'}}</div>
                    </label>
                    <md-input-container class="form-group full-field pa-mt-30-imp" flex-gt-sm>
                        <label>Card number <div class="pa-color-red pa-display-inline-block">*</div></label>
                        <div id="card-number-element-mobile" class='stripe-field'></div>
                        <span class="brand" id='brand-image-mobile'></span>
                    </md-input-container>

                    <md-input-container class="form-group half-field pa-mt-30-imp" flex-gt-sm>
                        <label>Expiry date <div class="pa-color-red pa-display-inline-block">*</div></label>
                        <div id="card-expiry-element-mobile" class='stripe-field'></div>
                    </md-input-container>

                    <md-input-container class="form-group half-field pa-mt-30-imp" flex-gt-sm>
                        <label>CVC <div class="pa-color-red pa-display-inline-block">*</div></label>
                        <div id="card-cvc-element-mobile" class='stripe-field'></div>
                    </md-input-container>

                    <md-input-container class="form-group full-field pa-mt-30-imp" flex-gt-sm>
                        <label>Postal code <div class="pa-color-red pa-display-inline-block">*</div></label>
                        <div id="card-postalcode-element-mobile" name="postal_code" class='stripe-field'
                            placeholder="90210"></div>
                    </md-input-container>
                </div>
                <button type="submit" id="submit_button2"
                    class="pa-font-Lato pa-bold-font pa-border-4 tt-font-16 continue md-button ng-scope md-ink-ripple">Make
                    Payment</button>
                <div class="outcome">
                    <div class="error"></div>
                </div>
            </form>
        </div>
        <div class="modal fade" data-backdrop="false" id="orderSummary" role="dialog">
            <div class="modal-dialog popup-perent rewardtermspopup  custom-model-content">
                <div class="modal-header pa-background-white">
                    <md-icon class="pa-float-right" class="close" data-dismiss="modal" aria-label="Close">close
                    </md-icon>
                </div>
                <div class="modal-body pa-text-center pa-background-white">
                    <div class="form-poup-congratulations">
                        <div class="order_summary">
                            <span class="order_summary_head">Order Summary</span>
                            <table>
                                <thead>
                                    <tr>
                                        <th>Tickets</th>
                                        <th>Unit Price</th>
                                        <th>Total Price</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-if="price_calculation.length > 0"
                                        ng-repeat="ticke_Details in price_calculation">
                                        <td><span ng-if="ticke_Details._tier_id > 0"
                                                style="background-color: {{ ticke_Details.tire_color  }};"></span> {{
                                            ticke_Details.qty }} x {{ticke_Details.name }}</td>
                                        <td>${{ticke_Details.unit_price }}</td>
                                        <td>${{ticke_Details.total_price }}</td>
                                    </tr>
                                </tbody>
                                <tfoot>
                                    <tr class="top_order_summary_space">
                                        <td>Sub Total</td>
                                        <td></td>
                                        <td>${{sub_total}}</td>
                                    </tr>
                                    <tr>
                                        <td>Fees</td>
                                        <td></td>
                                        <td>${{total_fee}}</td>
                                    </tr>
                                    <tr>
                                        <td><b>Total</b></td>
                                        <td></td>
                                        <td><b>${{total_amt}}</b></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="checkout_btn_ft_mob">
            <div class="checkout_cart_sec">
                <div class="checkout_cart_sec_count">
                    <a ng-disabled="checkoutDetails.quantity === 0" data-toggle="modal" data-target="#orderSummary">
                        <span class="checkout_cart_num"><i class="material-icons">shopping_cart</i>
                            <p ng-if="checkoutDetails.quantity">{{checkoutDetails.quantity}}</p>
                        </span>
                        <span class="checkout_cart_amount" ng-if="checkoutDetails.quantity > 0">{{currency}}
                            {{checkoutDetails.price}} <i class="material-icons">keyboard_arrow_down</i></span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>